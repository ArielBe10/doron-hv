#pragma once

#define VMCS_VM_EXIT_REASON_MASK 0xffff


enum {
    EXIT_REASON_EXCEPTION_NMI                   = 0,
    EXIT_REASON_EXTERNAL_INTERRUPT              = 1,
    EXIT_REASON_TRIPLE_FAULT                    = 2,
    EXIT_REASON_INIT                            = 3,
    EXIT_REASON_SIPI                            = 4,
    EXIT_REASON_IO_SMI                          = 5,
    EXIT_REASON_OTHER_SMI                       = 6,
    EXIT_REASON_PENDING_VIRT_INTR               = 7,
    EXIT_REASON_PENDING_VIRT_NMI                = 8,
    EXIT_REASON_TASK_SWITCH                     = 9,
    EXIT_REASON_CPUID                           = 10,
    EXIT_REASON_GETSEC                          = 11,
    EXIT_REASON_HLT                             = 12,
    EXIT_REASON_INVD                            = 13,
    EXIT_REASON_INVLPG                          = 14,
    EXIT_REASON_RDPMC                           = 15,
    EXIT_REASON_RDTSC                           = 16,
    EXIT_REASON_RSM                             = 17,
    EXIT_REASON_VMCALL                          = 18,
    EXIT_REASON_VMCLEAR                         = 19,
    EXIT_REASON_VMLAUNCH                        = 20,
    EXIT_REASON_VMPTRLD                         = 21,
    EXIT_REASON_VMPTRST                         = 22,
    EXIT_REASON_VMREAD                          = 23,
    EXIT_REASON_VMRESUME                        = 24,
    EXIT_REASON_VMWRITE                         = 25,
    EXIT_REASON_VMXOFF                          = 26,
    EXIT_REASON_VMXON                           = 27,
    EXIT_REASON_CR_ACCESS                       = 28,
    EXIT_REASON_DR_ACCESS                       = 29,
    EXIT_REASON_IO_INSTRUCTION                  = 30,
    EXIT_REASON_MSR_READ                        = 31,
    EXIT_REASON_MSR_WRITE                       = 32,
    EXIT_REASON_INVALID_GUEST_STATE             = 33,
    EXIT_REASON_MSR_LOADING                     = 34,
    EXIT_REASON_MWAIT_INSTRUCTION               = 36,
    EXIT_REASON_MONITOR_TRAP_FLAG               = 37,
    EXIT_REASON_MONITOR_INSTRUCTION             = 39,
    EXIT_REASON_PAUSE_INSTRUCTION               = 40,
    EXIT_REASON_MCE_DURING_VMENTRY              = 41,
    EXIT_REASON_TPR_BELOW_THRESHOLD             = 43,
    EXIT_REASON_APIC_ACCESS                     = 44,
    EXIT_REASON_ACCESS_GDTR_OR_IDTR             = 46,
    EXIT_REASON_ACCESS_LDTR_OR_TR               = 47,
    EXIT_REASON_EPT_VIOLATION                   = 48,
    EXIT_REASON_EPT_MISCONFIG                   = 49,
    EXIT_REASON_INVEPT                          = 50,
    EXIT_REASON_RDTSCP                          = 51,
    EXIT_REASON_VMX_PREEMPTION_TIMER_EXPIRED    = 52,
    EXIT_REASON_INVVPID                         = 53,
    EXIT_REASON_WBINVD                          = 54,
    EXIT_REASON_XSETBV                          = 55,
    EXIT_REASON_APIC_WRITE                      = 56,
    EXIT_REASON_RDRAND                          = 57,
    EXIT_REASON_INVPCID                         = 58,
    EXIT_REASON_RDSEED                          = 61,
    EXIT_REASON_PML_FULL                        = 62,
    EXIT_REASON_XSAVES                          = 63,
    EXIT_REASON_XRSTORS                         = 64,
    EXIT_REASON_PCOMMIT                         = 65,
    EXIT_REASON_UMWAIT                          = 67,
    EXIT_REASON_TPAUSE                          = 68
};


const char *EXIT_REASON_NAMES[] = {
    [EXIT_REASON_EXCEPTION_NMI] = "EXIT_REASON_EXCEPTION_NMI",
    [EXIT_REASON_EXTERNAL_INTERRUPT] = "EXIT_REASON_EXTERNAL_INTERRUPT",
    [EXIT_REASON_TRIPLE_FAULT] = "EXIT_REASON_TRIPLE_FAULT",
    [EXIT_REASON_INIT] = "EXIT_REASON_INIT",
    [EXIT_REASON_SIPI] = "EXIT_REASON_SIPI",
    [EXIT_REASON_IO_SMI] = "EXIT_REASON_IO_SMI",
    [EXIT_REASON_OTHER_SMI] = "EXIT_REASON_OTHER_SMI",
    [EXIT_REASON_PENDING_VIRT_INTR] = "EXIT_REASON_PENDING_VIRT_INTR",
    [EXIT_REASON_PENDING_VIRT_NMI] = "EXIT_REASON_PENDING_VIRT_NMI",
    [EXIT_REASON_TASK_SWITCH] = "EXIT_REASON_TASK_SWITCH",
    [EXIT_REASON_CPUID] = "EXIT_REASON_CPUID",
    [EXIT_REASON_GETSEC] = "EXIT_REASON_GETSEC",
    [EXIT_REASON_HLT] = "EXIT_REASON_HLT",
    [EXIT_REASON_INVD] = "EXIT_REASON_INVD",
    [EXIT_REASON_INVLPG] = "EXIT_REASON_INVLPG",
    [EXIT_REASON_RDPMC] = "EXIT_REASON_RDPMC",
    [EXIT_REASON_RDTSC] = "EXIT_REASON_RDTSC",
    [EXIT_REASON_RSM] = "EXIT_REASON_RSM",
    [EXIT_REASON_VMCALL] = "EXIT_REASON_VMCALL",
    [EXIT_REASON_VMCLEAR] = "EXIT_REASON_VMCLEAR",
    [EXIT_REASON_VMLAUNCH] = "EXIT_REASON_VMLAUNCH",
    [EXIT_REASON_VMPTRLD] = "EXIT_REASON_VMPTRLD",
    [EXIT_REASON_VMPTRST] = "EXIT_REASON_VMPTRST",
    [EXIT_REASON_VMREAD] = "EXIT_REASON_VMREAD",
    [EXIT_REASON_VMRESUME] = "EXIT_REASON_VMRESUME",
    [EXIT_REASON_VMWRITE] = "EXIT_REASON_VMWRITE",
    [EXIT_REASON_VMXOFF] = "EXIT_REASON_VMXOFF",
    [EXIT_REASON_VMXON] = "EXIT_REASON_VMXON",
    [EXIT_REASON_CR_ACCESS] = "EXIT_REASON_CR_ACCESS",
    [EXIT_REASON_DR_ACCESS] = "EXIT_REASON_DR_ACCESS",
    [EXIT_REASON_IO_INSTRUCTION] = "EXIT_REASON_IO_INSTRUCTION",
    [EXIT_REASON_MSR_READ] = "EXIT_REASON_MSR_READ",
    [EXIT_REASON_MSR_WRITE] = "EXIT_REASON_MSR_WRITE",
    [EXIT_REASON_INVALID_GUEST_STATE] = "EXIT_REASON_INVALID_GUEST_STATE",
    [EXIT_REASON_MSR_LOADING] = "EXIT_REASON_MSR_LOADING",
    [EXIT_REASON_MWAIT_INSTRUCTION] = "EXIT_REASON_MWAIT_INSTRUCTION",
    [EXIT_REASON_MONITOR_TRAP_FLAG] = "EXIT_REASON_MONITOR_TRAP_FLAG",
    [EXIT_REASON_MONITOR_INSTRUCTION] = "EXIT_REASON_MONITOR_INSTRUCTION",
    [EXIT_REASON_PAUSE_INSTRUCTION] = "EXIT_REASON_PAUSE_INSTRUCTION",
    [EXIT_REASON_MCE_DURING_VMENTRY] = "EXIT_REASON_MCE_DURING_VMENTRY",
    [EXIT_REASON_TPR_BELOW_THRESHOLD] = "EXIT_REASON_TPR_BELOW_THRESHOLD",
    [EXIT_REASON_APIC_ACCESS] = "EXIT_REASON_APIC_ACCESS",
    [EXIT_REASON_ACCESS_GDTR_OR_IDTR] = "EXIT_REASON_ACCESS_GDTR_OR_IDTR",
    [EXIT_REASON_ACCESS_LDTR_OR_TR] = "EXIT_REASON_ACCESS_LDTR_OR_TR",
    [EXIT_REASON_EPT_VIOLATION] = "EXIT_REASON_EPT_VIOLATION",
    [EXIT_REASON_EPT_MISCONFIG] = "EXIT_REASON_EPT_MISCONFIG",
    [EXIT_REASON_INVEPT] = "EXIT_REASON_INVEPT",
    [EXIT_REASON_RDTSCP] = "EXIT_REASON_RDTSCP",
    [EXIT_REASON_VMX_PREEMPTION_TIMER_EXPIRED] = "EXIT_REASON_VMX_PREEMPTION_TIMER_EXPIRED",
    [EXIT_REASON_INVVPID] = "EXIT_REASON_INVVPID",
    [EXIT_REASON_WBINVD] = "EXIT_REASON_WBINVD",
    [EXIT_REASON_XSETBV] = "EXIT_REASON_XSETBV",
    [EXIT_REASON_APIC_WRITE] = "EXIT_REASON_APIC_WRITE",
    [EXIT_REASON_RDRAND] = "EXIT_REASON_RDRAND",
    [EXIT_REASON_INVPCID] = "EXIT_REASON_INVPCID",
    [EXIT_REASON_RDSEED] = "EXIT_REASON_RDSEED",
    [EXIT_REASON_PML_FULL] = "EXIT_REASON_PML_FULL",
    [EXIT_REASON_XSAVES] = "EXIT_REASON_XSAVES",
    [EXIT_REASON_XRSTORS] = "EXIT_REASON_XRSTORS",
    [EXIT_REASON_PCOMMIT] = "EXIT_REASON_PCOMMIT",
    [EXIT_REASON_UMWAIT] = "EXIT_REASON_UMWAIT",
    [EXIT_REASON_TPAUSE] = "EXIT_REASON_TPAUSE"
};